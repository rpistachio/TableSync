<view class="home-container {{cookStatus === 'tired' ? 'mood-tired' : ''}}">
  <view class="brand-header">
    <view class="header-content">
      <text class="brand-watermark">TableSync</text>
    </view>
  </view>

  <view class="home-main">
    <view class="home-main-content">
      <!-- 今日氛围卡片（仅日期 + 问候） -->
      <view class="vibe-card">
        <text class="vibe-date">{{currentDate}}</text>
        <text class="vibe-greeting">{{vibeGreeting}}</text>
      </view>

      <!-- ===== Hero 插图 ===== -->
      <view class="zen-panel" wx:if="{{!showAdvanced}}">
        <view class="zen-illustration" wx:if="{{illustrationUrl}}">
          <image src="{{illustrationUrl}}" mode="widthFix" class="zen-illo-img" />
        </view>
      </view>

  <!-- ===== 高级功能入口（默认隐藏） ===== -->
  <block wx:if="{{showAdvanced}}">
  <view class="zen-advanced-back" bindtap="onHideAdvanced">
    <text class="zen-advanced-back-icon">‹</text>
    <text class="zen-advanced-back-text">返回</text>
  </view>
  <!-- 导入赛博菜谱入口 -->
  <view class="feature-entry import-entry" bindtap="onGoImport">
    <view class="feature-icon-wrap import-icon-wrap">
      <text class="feature-icon">🔗</text>
    </view>
    <view class="feature-text-wrap">
      <text class="feature-title">导入菜谱</text>
      <text class="feature-desc">截图小红书/抖音菜谱，秒变可执行食谱</text>
    </view>
    <text class="feature-arrow">›</text>
  </view>

  <!-- 混合组餐入口 -->
  <view class="feature-entry mix-entry" bindtap="onGoMix">
    <view class="feature-icon-wrap mix-icon-wrap">
      <text class="feature-icon">🍳</text>
    </view>
    <view class="feature-text-wrap">
      <text class="feature-title">自选搭配</text>
      <text class="feature-desc">自由搭配内置 + 外部菜谱，一键统筹做饭</text>
    </view>
    <text class="feature-arrow">›</text>
  </view>

  <!-- 我的菜谱库入口 -->
  <view class="feature-entry myrecipes-entry" bindtap="onGoMyRecipes">
    <view class="feature-icon-wrap myrecipes-icon-wrap">
      <text class="feature-icon">📚</text>
    </view>
    <view class="feature-text-wrap">
      <text class="feature-title">我的菜谱库</text>
      <text class="feature-desc">过去做过的菜，今天继续做</text>
    </view>
    <text class="feature-arrow">›</text>
  </view>

  <!-- 我的冰箱入口 -->
  <view class="feature-entry fridge-entry" bindtap="onGoFridge">
    <view class="feature-icon-wrap fridge-icon-wrap">
      <text class="feature-icon">🧊</text>
    </view>
    <view class="feature-text-wrap">
      <text class="feature-title">我的冰箱</text>
      <text class="feature-desc">{{fridgeHint || '记录食材，AI 帮你优先消耗临期的'}}</text>
    </view>
    <text class="feature-arrow">›</text>
  </view>
  </block>

  <!-- 更多高级功能入口（Zen 模式下显示） -->
  <view class="zen-advanced-link" wx:if="{{!showAdvanced}}" bindtap="onShowAdvanced">
    <text>更多高级功能 ▾</text>
  </view>

  <!-- 品牌露出已移至顶部水印，底部空间留给烟火集 -->
  </view>
  </view>

  <!-- ===== 烟火集：底部居中横向书签入口 ===== -->
  <view class="collection-spine {{spineMode}} {{spineHighlight ? 'spine-highlight' : ''}}"
        bindtap="onGoCollection">
    <view class="spine-seal">
      <view class="spine-seal-icon">{{spineSealIcon}}</view>
      <view class="spine-glow-layer" wx:if="{{hasUnviewedCooks}}"></view>
    </view>
    <text class="spine-text">烟火集</text>
  </view>

  <sticker-drop
    visible="{{showStickerDrop}}"
    queue="{{stickerDropQueue}}"
    bindclose="onStickerDropClose"
  />

  <cooking-loading visible="{{showCookingLoading}}" />

  <!-- Fixed Bottom Action Bar -->
  <view class="home-bottom-bar">
    <view class="home-main-cta" bindtap="onOpenSheet">
      <text class="home-main-cta-text">想想吃什么</text>
    </view>
    <view class="home-shake-fab" bindtap="_onShakeDetected">
      <view class="fab-shake-icon">
        <view class="fab-phone-body"></view>
        <view class="fab-phone-wave fab-wave-l"></view>
        <view class="fab-phone-wave fab-wave-r"></view>
      </view>
    </view>
  </view>

  <!-- 摇一摇触发时的模糊遮罩 -->
  <view class="shake-blur-overlay {{shakeBlur ? 'is-active' : ''}}" wx:if="{{shakeBlur}}">
    <view class="shake-blur-text">正在为你安排...</view>
  </view>

  <!-- Context Dashboard Sheet -->
  <view class="sheet-overlay {{showSheet ? 'is-visible' : ''}}"
        wx:if="{{showSheet}}" bindtap="onCloseSheet"></view>
  <view class="sheet-panel {{showSheet ? 'is-open' : ''}}">
    <view class="sheet-handle"></view>

    <view class="sheet-section">
      <text class="sheet-section-label">今晚什么局？</text>
      <scroll-view class="sheet-pills-scroll" scroll-x enable-flex>
        <view class="sheet-pills">
          <view wx:for="{{sheetSceneOptions}}" wx:key="key"
                class="sheet-pill {{sheetScene === item.key ? 'is-active' : ''}}"
                data-key="{{item.key}}" bindtap="onSheetSceneSelect">
            <text>{{item.label}}</text>
          </view>
        </view>
      </scroll-view>
    </view>

    <view class="sheet-section" wx:if="{{sheetShowTaste}}">
      <text class="sheet-section-label">{{sheetTasteQuestion}}</text>
      <scroll-view class="sheet-pills-scroll" scroll-x enable-flex>
        <view class="sheet-pills">
          <view wx:for="{{sheetTasteOptions}}" wx:key="key"
                class="sheet-pill {{sheetTaste === item.key ? 'is-active' : ''}}"
                data-key="{{item.key}}" bindtap="onSheetTasteSelect">
            <text>{{item.label}}</text>
          </view>
        </view>
      </scroll-view>
    </view>

    <view class="sheet-section">
      <text class="sheet-section-label">当前状态</text>
      <view class="sheet-status-toggle">
        <view class="toggle-track {{sheetStatus === 'tired' ? 'is-tired' : ''}}">
          <view class="toggle-option {{sheetStatus === 'tired' ? 'is-active' : ''}}"
                data-value="tired" bindtap="onSheetStatusToggle">
            <text>疲惫</text>
          </view>
          <view class="toggle-option {{sheetStatus === 'ok' ? 'is-active' : ''}}"
                data-value="ok" bindtap="onSheetStatusToggle">
            <text>还好</text>
          </view>
          <view class="toggle-thumb {{sheetStatus === 'tired' ? 'is-left' : 'is-right'}}"></view>
        </view>
      </view>
    </view>

    <view class="sheet-section" wx:if="{{sheetKitchenOptions.length > 0}}">
      <text class="sheet-section-label">家里有哪些厨具？</text>
      <scroll-view class="sheet-pills-scroll" scroll-x enable-flex>
        <view class="sheet-pills">
          <view wx:for="{{sheetKitchenOptions}}" wx:key="key"
                class="sheet-pill {{(item.key == null && sheetKitchen.length === 0) || (item.key && sheetKitchenSet[item.key]) ? 'is-active' : ''}}"
                data-key="{{item.key}}" bindtap="onSheetKitchenToggle">
            <text>{{item.label}}</text>
          </view>
        </view>
      </scroll-view>
    </view>

    <view class="sheet-confirm-btn" bindtap="onSheetConfirm">
      <text class="sheet-confirm-text">生成推荐</text>
    </view>
  </view>
</view>
