<view class="home-container">
  <view class="brand-header">
    <view class="header-content">
      <image
        class="brand-logo"
        src="cloud://cloud1-7g5mdmib90e9f670.636c-cloud1-7g5mdmib90e9f670-1401654193/logo/logo-remove-removebg-preview.png"
        mode="widthFix"
      />
      <text class="brand-slogan">Eat. Connect. Automate.</text>
    </view>
  </view>

  <!-- 今日氛围卡片（Phase 2 填充天气/问候） -->
  <view class="vibe-card">
    <text class="vibe-date">{{currentDate}}</text>
    <text class="vibe-weather" wx:if="{{vibeWeather}}">{{vibeWeather}}</text>
    <text class="vibe-greeting">{{vibeGreeting}}</text>
  </view>

  <!-- ===== Zen Mode: 一键定晚饭 ===== -->
  <view class="zen-panel" wx:if="{{!showAdvanced}}">
    <view class="zen-main-btn" bindtap="onZenGo">
      <text class="zen-main-btn-icon">🍽</text>
      <text class="zen-main-btn-text">帮我定晚饭</text>
    </view>

    <view class="zen-toggle-row">
      <text class="zen-toggle-label">谁来做</text>
      <view class="zen-toggle-track">
        <view class="zen-toggle-item {{cookWho === 'self' ? 'is-active' : ''}}" data-value="self" bindtap="onToggleCookWho">
          <text class="zen-toggle-text">自己做</text>
        </view>
        <view class="zen-toggle-item {{cookWho === 'ayi' ? 'is-active' : ''}}" data-value="ayi" bindtap="onToggleCookWho">
          <text class="zen-toggle-text">阿姨做</text>
        </view>
      </view>
    </view>

    <view class="zen-toggle-row">
      <text class="zen-toggle-label">今天状态</text>
      <view class="zen-toggle-track">
        <view class="zen-toggle-item {{cookStatus === 'ok' ? 'is-active' : ''}}" data-value="ok" bindtap="onToggleCookStatus">
          <text class="zen-toggle-text">还行</text>
        </view>
        <view class="zen-toggle-item {{cookStatus === 'tired' ? 'is-active' : ''}}" data-value="tired" bindtap="onToggleCookStatus">
          <text class="zen-toggle-text">很累</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ===== 高级功能入口（默认隐藏） ===== -->
  <block wx:if="{{showAdvanced}}">
  <!-- 今天吃什么入口 -->
  <view class="fridge-scan-entry today-entry" bindtap="onGoSpinner">
    <view class="fridge-scan-icon-wrap today-icon-wrap">
      <text class="fridge-scan-icon">🎲</text>
    </view>
    <view class="fridge-scan-text-wrap">
      <text class="fridge-scan-title">今天吃什么</text>
      <text class="fridge-scan-desc">输入心情，AI 帮你搭配今日晚餐</text>
    </view>
    <!-- 灵感篮子角标 -->
    <view class="basket-badge" wx:if="{{basketCount > 0}}">
      <text class="basket-badge-num">{{basketCount}}</text>
    </view>
    <text class="fridge-scan-arrow">›</text>
  </view>

  <!-- 拍照清冰箱入口 -->
  <view class="fridge-scan-entry" bindtap="onGoScan">
    <view class="fridge-scan-icon-wrap">
      <text class="fridge-scan-icon">📷</text>
    </view>
    <view class="fridge-scan-text-wrap">
      <text class="fridge-scan-title">拍照清冰箱</text>
      <text class="fridge-scan-desc">拍冰箱照片，AI 帮你搭配晚餐</text>
    </view>
    <text class="fridge-scan-arrow">›</text>
  </view>

  <!-- 导入赛博菜谱入口 -->
  <view class="fridge-scan-entry import-entry" bindtap="onGoImport">
    <view class="fridge-scan-icon-wrap import-icon-wrap">
      <text class="fridge-scan-icon">🔗</text>
    </view>
    <view class="fridge-scan-text-wrap">
      <text class="fridge-scan-title">导入赛博菜谱</text>
      <text class="fridge-scan-desc">截图小红书/抖音菜谱，AI 秒变可执行食谱</text>
    </view>
    <text class="fridge-scan-arrow">›</text>
  </view>

  <!-- 混合组餐入口 -->
  <view class="fridge-scan-entry mix-entry" bindtap="onGoMix">
    <view class="fridge-scan-icon-wrap mix-icon-wrap">
      <text class="fridge-scan-icon">🍳</text>
    </view>
    <view class="fridge-scan-text-wrap">
      <text class="fridge-scan-title">混合组餐</text>
      <text class="fridge-scan-desc">自由搭配原生 + 导入菜谱，一键统筹做饭</text>
    </view>
    <text class="fridge-scan-arrow">›</text>
  </view>

  <!-- 我的菜谱库入口 -->
  <view class="fridge-scan-entry myrecipes-entry" bindtap="onGoMyRecipes">
    <view class="fridge-scan-icon-wrap myrecipes-icon-wrap">
      <text class="fridge-scan-icon">📚</text>
    </view>
    <view class="fridge-scan-text-wrap">
      <text class="fridge-scan-title">我的菜谱库</text>
      <text class="fridge-scan-desc">过去做过的菜，今天继续做</text>
    </view>
    <text class="fridge-scan-arrow">›</text>
  </view>
  </block>

  <!-- 灵感篮子预览条（篮子非空时显示） -->
  <view class="basket-bar" wx:if="{{basketCount > 0}}" bindtap="onGoBasketPreview">
    <text class="basket-bar-icon">🧺</text>
    <text class="basket-bar-text">今日灵感篮 · {{basketCount}} 道备选</text>
    <text class="basket-bar-arrow">›</text>
  </view>

  <!-- Phase C：历史推荐「再来一次？」（篮子为空且有 7 天内记录时显示） -->
  <view class="history-hint-card" wx:if="{{basketCount === 0 && showHistoryHint && historyDishNames.length > 0}}" bindtap="onGoBasketPreview">
    <text class="history-hint-title">再来一次？</text>
    <text class="history-hint-dishes">{{historyDishNames[0]}}{{historyDishNames[1] ? '、' + historyDishNames[1] : ''}}{{historyDishNames[2] ? '、' + historyDishNames[2] : ''}}</text>
    <text class="history-hint-cta">去看看 · 加入今日灵感篮</text>
    <text class="history-hint-arrow">›</text>
  </view>

  <!-- 更多高级功能入口（Zen 模式下显示） -->
  <view class="zen-advanced-link" wx:if="{{!showAdvanced}}" bindtap="onShowAdvanced">
    <text>更多高级功能（扫描/导入）▾</text>
  </view>

  <view class="home-brand">
    <view class="brand-line"></view>
    <text class="brand-text">TableSync</text>
  </view>
</view>
