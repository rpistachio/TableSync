<view class="preview-page {{isTiredMode ? 'preview-page-tired' : ''}} {{isHelperMode ? 'preview-page-helper' : ''}}">
  <view class="preview-page-scroll">
    <view class="preview-scroll-content">
      <view class="preview-header">
        <view class="preview-header-text">
          <text class="preview-header-title">营养师推荐理由</text>
          <text class="preview-narrative">{{previewNarrativeText}}</text>
        </view>
        <view class="preview-header-divider"></view>
      </view>

      <scroll-view wx:if="{{isHelperMode || previewDashboard.estimatedTime || previewDashboard.stoveCount > 0 || previewDashboard.categoryLabels}}" class="dashboard-bar" scroll-x enable-flex>
        <block wx:if="{{isHelperMode}}">
          <view class="dash-item dash-item-helper">
            <text class="dash-value">上手难度：极简</text>
          </view>
        </block>
        <block wx:else>
          <view class="dash-item">
            <text class="dash-value">{{previewDashboard.estimatedTime}}</text>
          </view>
          <view class="dash-item">
            <text class="dash-value">{{previewDashboard.stoveCount}}火</text>
          </view>
          <view class="dash-item" wx:if="{{previewDashboard.categoryLabels}}">
            <text class="dash-value">{{previewDashboard.categoryLabels}}</text>
          </view>
        </block>
      </scroll-view>

      <view class="preview-menu-header">
        <view class="preview-menu-titles">
          <text class="preview-menu-label">{{previewPageTitle}}</text>
        </view>
      </view>
      <view class="preview-baby-hint" wx:if="{{previewHasBaby && !isHelperMode}}">下方标「宝宝」的为宝宝辅食</view>

      <block wx:if="{{isHelperMode}}">
        <view class="helper-card-wrap">
          <helper-card
            mergedTitle="{{helperData.mergedTitle}}"
            combinedPrepItems="{{helperData.combinedPrepItems}}"
            combinedActions="{{helperData.combinedActions}}"
            heartMessage="{{helperData.heartMessage}}"
          />
        </view>
      </block>

      <view wx:if="{{!isHelperMode}}" class="preview-dish-list">
        <view wx:for="{{previewMenuRows}}" wx:key="index" class="dish-card-wrap" data-index="{{index}}" bindtap="onCheckRow">
          <view class="dish-card-modern {{item.checked ? '' : 'is-unchecked'}} {{item.hasCover ? '' : 'no-cover'}}" style="animation-delay: {{index * 120}}ms">
            <image wx:if="{{item.hasCover && isImageReady && item.coverTempUrl}}" class="card-bg" src="{{item.coverTempUrl}}" mode="aspectFill" />
            <view class="card-overlay"></view>
            <view class="airfryer-tag" wx:if="{{isTiredMode && item.cookType === 'air_fryer'}}">空气炸锅</view>
            <view class="card-info">
              <view class="card-header">
                <text class="dish-name">{{item.adultName}}</text>
                <view class="check-badge" wx:if="{{item.checked}}">✓</view>
              </view>
              <view class="card-footer">
                <text class="dish-reason">{{item.recommendReason}}</text>
                <view class="baby-tag-floating" wx:if="{{item.babyName}}">宝宝吃：{{item.babyName}}</view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <view class="preview-actions">
    <button class="preview-btn preview-btn-secondary" catchtap="handleSwapOptions">换菜</button>
    <button class="preview-btn preview-btn-ghost" open-type="share">发给别人</button>
    <button wx:if="{{!isHelperMode}}" class="preview-btn preview-btn-primary" catchtap="confirmAndGo">{{previewPrimaryCta}}</button>
  </view>
</view>
