<view class="preview-page {{largeTextMode ? 'large-text-mode' : ''}}">
  <scroll-view class="preview-page-scroll" scroll-y>
    <view class="preview-scroll-content">
      <view class="preview-top-bar">
        <view class="preview-top-bar-spacer"></view>
        <view class="preview-large-mode-btn {{largeTextMode ? 'is-active' : ''}}" bindtap="onLargeTextModeTap">
          <text class="preview-large-mode-icon">ğŸ”¤</text>
          <text class="preview-large-mode-label">{{largeTextMode ? 'é€€å‡ºå¤§å­—' : 'å¤§å­—æ¨¡å¼'}}</text>
        </view>
      </view>
      <view class="preview-header">
        <image wx:if="{{isImageReady && headerBgUrl}}" class="header-bg-image" src="{{headerBgUrl}}" mode="aspectFill" />
        <view class="header-bg-overlay"></view>
        <view class="header-brand-lines"></view>
        <text class="preview-heading">ä»Šæ—¥ç”¨é¤</text>
        <text class="preview-count">{{previewCountText}}</text>
        <text class="preview-combo" wx:if="{{previewComboName}}">{{previewComboName}}</text>
        <text class="preview-balance" wx:if="{{previewBalanceTip}}">{{previewBalanceTip}}</text>
      </view>
      
      <!-- èœè°±æ± é™çº§æç¤º -->
      <view class="preview-fallback-notice" wx:if="{{previewFallbackMessage}}">
        <text class="fallback-icon">ğŸ’¡</text>
        <text class="fallback-text">{{previewFallbackMessage}}</text>
      </view>

      <scroll-view wx:if="{{previewDashboard.estimatedTime || previewDashboard.stoveCount > 0 || previewDashboard.categoryLabels}}" class="dashboard-bar" scroll-x enable-flex>
        <view class="dash-item">
          <text class="dash-icon">â°</text>
          <text class="dash-value">{{previewDashboard.estimatedTime}}</text>
        </view>
        <view class="dash-item">
          <text class="dash-icon">ğŸ”¥</text>
          <text class="dash-value">{{previewDashboard.stoveCount}}ç«</text>
        </view>
        <view class="dash-item" wx:if="{{previewDashboard.categoryLabels}}">
          <text class="dash-icon">ğŸ¥•</text>
          <text class="dash-value">{{previewDashboard.categoryLabels}}</text>
        </view>
      </scroll-view>

      <view class="preview-hints" wx:if="{{previewDashboard.nutritionHint || previewDashboard.prepOrderHint || previewDashboard.prepAheadHint || previewDashboard.sharedIngredientsHint}}">
        <view class="hint-row" wx:if="{{previewDashboard.sharedIngredientsHint}}">
          <text class="hint-icon">ğŸ›’</text>
          <text class="hint-text">{{previewDashboard.sharedIngredientsHint}}</text>
        </view>
        <view class="hint-row" wx:if="{{previewDashboard.nutritionHint}}">
          <text class="hint-icon">ğŸ¥—</text>
          <text class="hint-text">{{previewDashboard.nutritionHint}}</text>
        </view>
        <view class="hint-row" wx:if="{{previewDashboard.prepAheadHint}}">
          <text class="hint-icon">â±</text>
          <text class="hint-text">{{previewDashboard.prepAheadHint}}</text>
        </view>
        <view class="hint-row" wx:if="{{previewDashboard.prepOrderHint}}">
          <text class="hint-icon">ğŸ“‹</text>
          <text class="hint-text">{{previewDashboard.prepOrderHint}}</text>
        </view>
      </view>

      <view class="preview-baby-diff" wx:if="{{previewHasSharedBase}}">
        <text class="preview-baby-diff-icon">ğŸ’¡</text>
        <text class="preview-baby-diff-text">å¤§äººå­©å­å¯å…±ç”¨åŸºåº•ï¼Œä¸€é”…å‡ºçœæ—¶çœåŠ›</text>
      </view>

      <!-- ä¸»å¨æŠ¥å‘Šï¼šAI æ¨èç†ç”± -->
      <view class="chef-report" wx:if="{{chefReportText}}">
        <text class="chef-report-icon">ğŸ‘¨â€ğŸ³</text>
        <text class="chef-report-text">{{chefReportText}}</text>
      </view>

      <view class="preview-menu-label">ğŸ± ä»Šæ—¥èœå•</view>
      <view class="preview-baby-hint" wx:if="{{previewHasBaby}}">ğŸ‘¶ ä¸‹æ–¹æ ‡ã€Œå®å®ã€çš„ä¸ºå®å®è¾…é£Ÿ</view>

      <view class="preview-dish-list">
        <view wx:for="{{previewMenuRows}}" wx:key="index" class="dish-card-wrap" data-index="{{index}}" bindtap="onCheckRow">
          <view class="dish-card-modern {{item.checked ? '' : 'is-unchecked'}} {{item.hasCover ? '' : 'no-cover'}}" style="animation-delay: {{index * 120}}ms">
            <image wx:if="{{item.hasCover && isImageReady && item.coverTempUrl}}" class="card-bg" src="{{item.coverTempUrl}}" mode="aspectFill" />
            <view class="card-overlay"></view>
            <view class="card-info">
              <view class="card-header">
                <text class="dish-name">{{item.adultName}}</text>
                <view class="basket-origin-badge" wx:if="{{item.fromBasket}}">
                  <text class="basket-origin-text">ğŸ§º {{item.basketSourceLabel}}</text>
                </view>
                <view class="check-badge" wx:if="{{item.checked}}">âœ“</view>
              </view>
              <view class="card-footer">
                <text class="dish-reason">{{item.recommendReason}}</text>
                <view class="baby-tag-floating" wx:if="{{item.babyName}}">ğŸ‘¶ å®å®åƒï¼š{{item.babyName}}</view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>

  <view class="preview-actions">
    <button class="preview-btn preview-btn-secondary" catchtap="handleShuffle">æ¢ä¸€æ¢</button>
    <button class="preview-btn preview-btn-secondary" catchtap="handleReplaceUnchecked">æ¢æ‰æœªå‹¾é€‰</button>
    <button class="preview-btn preview-btn-share" open-type="share">å‘ç»™é˜¿å§¨</button>
    <button class="preview-btn preview-btn-primary" catchtap="confirmAndGo">å¼€å§‹åšé¥­</button>
  </view>
</view>
